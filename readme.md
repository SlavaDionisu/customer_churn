# Предсказание оттока пользователей

## Описание

Этот проект направлен на предсказание оттока клиентов телеком компании. Основная цель — построить модель, которая сможет предсказывать, какие клиенты собираются перестать пользоваться услугами компании, и попытаться удержать их, предложив какие-либо бонусы.

## Ссылка на саоревнование

[RunFMe. Предсказание оттока пользователей (весна 2021)](https://kaggle.com/competitions/advanced-dls-spring-2021)

## Метрика

В данном соревновании используется метрика ROC-AUC. Она позволяет оценить качество модели, не завися от конкретного порога классификации, и работает даже при сильном дисбалансе классов. Однако, так как нам важно заметить всех клиентов, которые собираются уйти, мы также будем обращать внимание на метрику Recall.

## Данные

В репозитории данного проекта расположены и используются только обучающие данные. Тестовые данные использовались для загрузки предсказаний на проверку в kaggle.

Данные содержат информацию о клиентах, включая:
- **ClientPeriod**: Продолжительность пребывания клиента в компании.
- **MonthlySpending**: Среднемесячные расходы клиента.
- **TotalSpent**: Общая сумма, потраченная клиентом.
- **Sex**: Пол клиента.
- **IsSeniorCitizen**: Является ли клиент пенсионером.
- **HasPartner**: Наличие партнера.
- **HasChild**: Наличие детей.
- **HasPhoneService**: Наличие телефонной услуги.
- **HasMultiplePhoneNumbers**: Наличие нескольких телефонных номеров.
- **HasInternetService**: Наличие интернет-услуг.
- **HasOnlineSecurityService**: Наличие услуги онлайн-безопасности.
- **HasOnlineBackup**: Наличие услуги онлайн-резервного копирования.
- **HasDeviceProtection**: Наличие защиты устройства.
- **HasTechSupportAccess**: Наличие доступа к технической поддержке.
- **HasOnlineTV**: Наличие услуги онлайн-ТВ.
- **HasMovieSubscription**: Наличие подписки на фильмы.
- **HasContractPhone**: Наличие телефонного контракта.
- **IsBillingPaperless**: Наличие безналичной оплаты.
- **PaymentMethod**: Метод оплаты.
- **Churn**: Целевая переменная, указывающая, ушел ли клиент (1) или остался (0).

## Анализ данных

### Пропущенные значения
- Пропуски в колонке `TotalSpent` были заполнены нулями.

### Дубликаты
- Дубликаты были удалены.

### Выбросы
- Выбросов в числовых колонках не обнаружено.

### Корреляции
- Колонка `TotalSpent` была исключена из-за мультиколлинеарности с другими признаками.

### Влияние признаков на целевую переменную
- Проведены t-тесты и χ² тесты для оценки влияния признаков на целевую переменную.
- Признаки `Sex` и `HasPhoneService` были исключены, так как они не оказывают значительного влияния на целевую переменную.

## Построенные модели

### Логистическая регрессия
- Стандартизация числовых признаков и one-hot-encoding для категориальных.
- Подбор оптимального значения C на кросс-валидации.
- Лучшее значение ROC-AUC: 0.8426, Recall: 0.52.

### Случайный лес
- Стандартные гиперпараметры.
- Подбор гиперпараметров на кросс-валидации.
- Лучшее значение ROC-AUC: 0.808, Recall: 0.69.

### CatBoost
- Стандартные гиперпараметры с балансировкой классов.
- Подбор гиперпараметров на кросс-валидации.
- Лучшее значение ROC-AUC: 0.8516, Recall: 0.68.

### XGBoost
- Стандартизация числовых признаков и one-hot-encoding для категориальных.
- Подбор гиперпараметров на кросс-валидации.
- Лучшее значение ROC-AUC: 0.849, Recall: 0.55.

## Оверсамплинг

### SMOTE
- Применение SMOTE для увеличения выборки.
- Подбор гиперпараметров на кросс-валидации.
- Лучшее значение ROC-AUC: 0.9357, Recall: 0.57.

### SMOTE + Tomek Links
- Применение SMOTE + Tomek Links для увеличения выборки.
- Подбор гиперпараметров на кросс-валидации.
- Лучшее значение ROC-AUC: 0.9505, Recall: 0.58.

### Оптимизация Recall
- Подбор гиперпараметров, ориентируясь на метрику Recall.
- Лучшее значение ROC-AUC: 0.9758, Recall: 0.94.

## Результаты

Модель CatBoost с оптимизацией по метрике Recall показала наилучшие результаты:
- ROC-AUC: 0.9758
- Recall: 0.94

## Общие требования
- Python 3.8.5 и выше
- Git
- pip (менеджер пакетов Python)

## Установка и запуск

1. Клонируйте репозиторий:
    ```bash
    git clone https://github.com/SlavaDionisu/customer_churn
    cd customer_churn
    ```

2. Создайте виртуальное окружение (рекомендуется):
    - Windows:
        ```bash
        python -m venv venv
        venv\Scripts\activate
        ```
    - macOS и Linux:
        ```bash
        python3 -m venv venv
        source venv/bin/activate
        ```

3. Установите зависимости:
    ```bash
    pip install -r requirements.txt
    ```

4. Запустите Jupyter Notebook в удобном вам редакторе кода или через терминал:
    ```bash
    jupyter notebook kaggle_user_churn_nb.ipynb
    ```